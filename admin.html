<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin - Survivor Pool</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>Admin Panel</h1>
    <nav>
      <a href="dashboard.html">Dashboard</a>
      <a href="picks.html">Picks</a>
      <a href="standings.html">Standings</a>
      <a href="admin.html" class="active">Admin</a>
      <a href="index.html">Logout</a>
    </nav>
  </header>

  <main>
    <h2>Manage Matchups</h2>
    <p>Select teams and spreads below. Choose which team is favored â€” the spread will automatically get a + or - sign.</p>

    <div class="admin-controls">
      <select id="homeTeamSelect">
        <option value="">Select Home Team</option>
      </select>
      <select id="awayTeamSelect">
        <option value="">Select Away Team</option>
      </select>
      <input type="number" id="spreadInput" placeholder="Spread (e.g. 3.5)" step="0.5" />
      <select id="favoredSelect">
        <option value="home">Home Favored</option>
        <option value="away">Away Favored</option>
      </select>
      <button id="addMatchupBtn">Add Matchup</button>
      <button id="clearAllBtn" class="danger-btn">Clear All</button>
    </div>

    <table id="adminGamesTable">
      <thead>
        <tr>
          <th>Home Team</th>
          <th>Away Team</th>
          <th>Spread</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </main>

  <footer>
    <p>&copy; 2025 NFL Survivor Pool</p>
  </footer>

  <script>
    const teams = [
      "49ers","Bears","Bengals","Bills","Broncos","Browns","Buccaneers","Cardinals",
      "Chargers","Chiefs","Colts","Commanders","Cowboys","Dolphins","Eagles","Falcons",
      "Giants","Jaguars","Jets","Lions","Packers","Panthers","Patriots","Raiders",
      "Rams","Ravens","Saints","Seahawks","Steelers","Texans","Titans","Vikings"
    ];

    const homeSelect = document.getElementById("homeTeamSelect");
    const awaySelect = document.getElementById("awayTeamSelect");
    const spreadInput = document.getElementById("spreadInput");
    const favoredSelect = document.getElementById("favoredSelect");
    const addBtn = document.getElementById("addMatchupBtn");
    const clearAllBtn = document.getElementById("clearAllBtn");
    const tableBody = document.querySelector("#adminGamesTable tbody");

    let matchups = JSON.parse(localStorage.getItem("matchups")) || [];

    // Populate dropdowns
    teams.forEach(t => {
      const opt1 = document.createElement("option");
      opt1.value = opt1.textContent = t;
      homeSelect.appendChild(opt1);

      const opt2 = document.createElement("option");
      opt2.value = opt2.textContent = t;
      awaySelect.appendChild(opt2);
    });

    // Render matchups
    function renderMatchups() {
      tableBody.innerHTML = "";
      if (matchups.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="4">No matchups added yet.</td></tr>`;
        return;
      }

      matchups.forEach((m, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${m.home}</td>
          <td>${m.away}</td>
          <td>${m.spread}</td>
          <td><button class="danger-btn" onclick="removeMatchup(${i})">Remove</button></td>
        `;
        tableBody.appendChild(row);
      });
    }

    // Add matchup
    addBtn.addEventListener("click", () => {
      const home = homeSelect.value;
      const away = awaySelect.value;
      const spreadVal = parseFloat(spreadInput.value);
      const favored = favoredSelect.value;

      if (!home || !away) {
        alert("Please select both teams.");
        return;
      }
      if (home === away) {
        alert("Teams must be different.");
        return;
      }
      if (isNaN(spreadVal)) {
        alert("Please enter a valid spread number.");
        return;
      }

      // Assign + or - automatically based on favored team
      const spread = favored === "home" ? -Math.abs(spreadVal) : Math.abs(spreadVal);

      matchups.push({ home, away, spread });
      localStorage.setItem("matchups", JSON.stringify(matchups));

      homeSelect.value = "";
      awaySelect.value = "";
      spreadInput.value = "";
      favoredSelect.value = "home";

      renderMatchups();
    });

    // Remove matchup
    function removeMatchup(index) {
      matchups.splice(index, 1);
      localStorage.setItem("matchups", JSON.stringify(matchups));
      renderMatchups();
    }

    // Clear all
    clearAllBtn.addEventListener("click", () => {
      if (confirm("Clear all matchups?")) {
        matchups = [];
        localStorage.removeItem("matchups");
        renderMatchups();
      }
    });

    renderMatchups();
  </script>
</body>
</html>
