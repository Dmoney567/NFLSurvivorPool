<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Make Your Pick - Survivor Pool</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>NFL Survivor Pool</h1>
    <nav>
      <a href="dashboard.html">Dashboard</a>
      <a href="picks.html" class="active">Picks</a>
      <a href="standings.html">Standings</a>
      <a href="admin.html">Admin</a>
      <a href="index.html">Logout</a>
    </nav>
  </header>

  <main>
    <h2>Make Your Pick</h2>
    <p>Select one team below. You can only pick one per week.</p>

    <div id="matchupsContainer" class="matchups-container"></div>
    <p id="chosenDisplay" class="chosen-display"></p>
    <button id="submitPickBtn" disabled>Submit Pick</button>
  </main>

  <footer>
    <p>&copy; 2025 NFL Survivor Pool</p>
  </footer>

  <script>
  const matchups = JSON.parse(localStorage.getItem("matchups")) || [];
  const container = document.getElementById("matchupsContainer");
  const submitBtn = document.getElementById("submitPickBtn");
  const chosenDisplay = document.getElementById("chosenDisplay");

  let chosenTeam = localStorage.getItem("chosenTeam") || "";

  // ==========================
  // Render Matchups
  // ==========================
function renderMatchups() {
  container.innerHTML = "";

  if (matchups.length === 0) {
    container.innerHTML = "<p>No matchups available yet. Check back later!</p>";
    return;
  }

  matchups.forEach((m) => {
    const home = m.home;
    const away = m.away;
    const spread = parseFloat(m.spread);
    let leftTeam, rightTeam, displaySpread, middleText;

    if (!isNaN(spread)) {
      if (spread < 0) {
        // Home is favored
        leftTeam = home;
        rightTeam = away;
        displaySpread = `-${Math.abs(spread)}`;
        middleText = "vs";
      } else if (spread > 0) {
        // Away is favored
        leftTeam = away;
        rightTeam = home;
        displaySpread = `-${Math.abs(spread)}`;
        middleText = "@";
      } else {
        // Pick'em
        leftTeam = home;
        rightTeam = away;
        displaySpread = "";
        middleText = "vs";
      }
    } else {
      // No valid spread
      leftTeam = home;
      rightTeam = away;
      displaySpread = "";
      middleText = "vs";
    }

    const matchupDiv = document.createElement("div");
    matchupDiv.classList.add("matchup");
    matchupDiv.innerHTML = `
      <div class="matchup-row">
        <button class="team-btn" onclick="chooseTeam('${leftTeam}')">${leftTeam}</button>
        <span class="spread">${displaySpread} ${middleText}</span>
        <button class="team-btn" onclick="chooseTeam('${rightTeam}')">${rightTeam}</button>
      </div>
    `;
    container.appendChild(matchupDiv);
  });

  if (chosenTeam) {
    chosenDisplay.innerText = `You picked: ${chosenTeam}`;
    submitBtn.disabled = false;
    const selectedBtn = [...document.querySelectorAll(".team-btn")].find(b => b.textContent === chosenTeam);
    if (selectedBtn) selectedBtn.classList.add("selected");
  }
}


  // ==========================
  // Choose Team
  // ==========================
  function chooseTeam(team) {
    chosenTeam = team;
    localStorage.setItem("chosenTeam", team);
    chosenDisplay.innerText = `You picked: ${team}`;
    submitBtn.disabled = false;

    document.querySelectorAll(".team-btn").forEach(btn => btn.classList.remove("selected"));
    const selectedBtn = [...document.querySelectorAll(".team-btn")].find(b => b.textContent === team);
    if (selectedBtn) selectedBtn.classList.add("selected");
  }

  // ==========================
  // Submit Pick
  // ==========================
  submitBtn.addEventListener("click", () => {
    alert(`You submitted your pick: ${chosenTeam}`);
  });

  renderMatchups();
</script>

</body>
</html>
